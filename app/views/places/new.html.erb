<div id="new_place_form">
  <form action="<%= url_for(:action => 'create') %>" method="post">
    <div class="standout"><label for="name"><%= t'place.name' %></label></div>
    <p><input type="text" id="name" name="name"></p>
    <p>
      <input type="hidden" id="lat" name="lat" value="default">
      <input type="hidden" id="long" name="long" value="default">
    </p>
    <div id="map">
    </div>
    <div class="standout"><%= t'place.category' %></div>
    <div id="accordion">
      <% @categories.keys().sort.each do |category| %>
        <h3><a href="#"><%= category %></a></h3>
        <div>
          <% @categories[category].keys().sort.each do |friendly_term|%>
            <p><input class="radio" type="radio" name="category" value="<%= @categories[category][friendly_term] %>"/><span class="radio_text"><%= friendly_term %></span></p>
          <% end %>
        </div>
      <% end %>  
    </div>
    <input id="create" class="button" type="submit" value="Create">
  </form>
</div>

<% content_for :javascript do %>
  <script src="/javascripts/jquery-ui-1.8.13.custom.min.js" type="text/javascript"></script>
  <script type='text/javascript'>
    $(function() {
      $( "#accordion" ).accordion({ collapsible: true, autoHeight: false, active:false });
    });
  </script>
  <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript">
    var crosshairShape = {coords:[0,0,0,0],type:'rect'};
    var latlng = new google.maps.LatLng(<%= current_user.location[0] %>, <%= current_user.location[1] %>);
    var myOptions = {
      zoom: 12,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      draggableCursor:'crosshair',
      mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}
    };
    var map = new google.maps.Map(document.getElementById("map"), myOptions);
    var marker = new google.maps.Marker({
      map: map,
      icon: 'http://www.daftlogic.com/images/cross-hairs.gif',
      shape: crosshairShape
    });
    marker.bindTo('position', map, 'center');
    // Update submit event
    $('#new_place_form').submit( function(e) {
      var lat = map.getCenter().lat(); 
      var lng = map.getCenter().lng();
      
      $('#lat').val(lat);
      $('#long').val(lng);
    });
  </script>
<% end %>